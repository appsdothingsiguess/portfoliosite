---
import BaseLayout from '../layouts/BaseLayout.astro';
import { getCollection } from 'astro:content';
import TechnicalSkills from '../components/TechnicalSkills.astro';
import TopSkills from '../components/TopSkills.astro';

// Determine current mode from URL params (server-side)
const url = Astro.url;
const params = url.searchParams;
let currentMode: 'research' | 'business' | 'journalism' | 'aba' = 'aba';
const hasExplicitMode = params.has('r') || params.has('b') || params.has('a') || params.has('j');
if (params.has('r')) currentMode = 'research';
if (params.has('b')) currentMode = 'business';
if (params.has('a')) currentMode = 'aba';
if (params.has('j')) currentMode = 'journalism';

// 1. Fetch Data from Content Collections
const researchDocs = await getCollection('research');
const leadershipDocs = await getCollection('leadership');
const businessDocs = await getCollection('business');
const journalismDocs = await getCollection('journalism');
const skillsDocs = await getCollection('skills');
const modesDocs = await getCollection('modes');

// 2. Always show all experiences (URL params only reorder, not filter)
const filteredResearch = researchDocs || [];
const filteredLeadership = leadershipDocs || [];
const filteredBusiness = businessDocs || [];
const filteredJournalism = journalismDocs || [];

// 3. Sort Data (Newest first)
const sortedResearch = filteredResearch.sort((a, b) => b.data.date.valueOf() - a.data.date.valueOf());
const sortedJournalism = filteredJournalism.sort((a, b) => b.data.date.valueOf() - a.data.date.valueOf());
const sortedLeadership = filteredLeadership.sort((a, b) => b.data.dateStart.valueOf() - a.data.dateStart.valueOf());
const sortedBusiness = filteredBusiness.sort((a, b) => b.data.dateStart.valueOf() - a.data.dateStart.valueOf());
const sortedSkills = (skillsDocs || []).sort((a, b) => 
  (a.data.order || 999) - (b.data.order || 999)
);

// 4. Hero content based on mode (loaded from modes collection)
const heroContent = Object.fromEntries(
  modesDocs.map(doc => [doc.id, {
    badge: { color: doc.data.badgeColor, text: doc.data.badgeText },
    title: doc.data.title,
    description: doc.data.description
  }])
);

// Fallback hero content if mode file is missing
const defaultHero = {
  badge: { color: 'bg-green-500', text: 'Portfolio' },
  title: 'Professional Portfolio',
  description: 'Welcome to my portfolio.'
};

const currentHero = heroContent[currentMode] || defaultHero;

// 5. Determine section order based on mode (always ends with skills and contact)
function getSectionOrder(mode: typeof currentMode): string[] {
  const baseOrder = {
    research: ['research', 'business-leadership', 'journalism'],
    business: ['business-leadership', 'journalism', 'research'],
    aba: ['research', 'business-leadership', 'journalism'],
    journalism: ['journalism', 'research', 'business-leadership']
  };
  return [...baseOrder[mode], 'skills', 'contact'];
}

const sectionOrder = getSectionOrder(currentMode);
---

<BaseLayout title="Joseph Abboud | Researcher & Operator">
  
  <!-- Navigation -->
  <nav class="sticky top-0 z-50 border-b border-border bg-surface/95 backdrop-blur-md">
    <div class="max-w-5xl mx-auto px-6 h-16 flex items-center justify-between">
      <a href="./" class="font-serif font-bold text-xl tracking-tight">Joseph Abboud</a>
      
      <div class="flex items-center gap-3">
        <a href="#research" class="btn-secondary px-3 py-2 rounded-lg text-xs font-semibold inline-flex items-center gap-2">
          <i data-lucide="microscope" class="w-4 h-4"></i>
          <span class="hidden sm:inline">Research</span>
        </a>
        <a href="#contact" class="btn-primary px-3 py-2 rounded-lg text-xs font-semibold inline-flex items-center gap-2">
          <i data-lucide="message-square" class="w-4 h-4"></i>
          <span class="hidden sm:inline">Connect</span>
        </a>
      </div>
    </div>
  </nav>

  <!-- Hero Section -->
  <header class="pt-16 pb-12 md:pt-24 md:pb-20 px-6 border-b border-border bg-gradient-to-b from-[var(--bg)] to-surface-2">
    <div class="max-w-5xl mx-auto flex flex-col-reverse md:flex-row items-center gap-10">
      
      <!-- Dynamic Text Content -->
      <div class="flex-1 text-center md:text-left">
        <div class="inline-flex items-center gap-2 px-3 py-1 rounded-full border border-border bg-surface mb-6 shadow-sm">
          <span class={`w-2 h-2 rounded-full ${currentHero.badge.color} animate-pulse`}></span>
          <span class="text-xs font-medium text-muted">{currentHero.badge.text}</span>
        </div>
        
        <h1 class="text-4xl md:text-5xl lg:text-6xl font-serif font-bold leading-[1.1] mb-6 text-balance text-[var(--text)]" set:html={currentHero.title}></h1>
        
        <p class="text-lg text-muted leading-relaxed max-w-xl mx-auto md:mx-0 mb-8">
          {currentHero.description}
        </p>

        <!-- Education Block -->
        <div class="mb-8 p-4 bg-surface border border-border rounded-xl inline-block text-left w-full md:w-auto shadow-sm">
          <div class="flex flex-col sm:flex-row gap-4 sm:items-center">
            <div class="flex items-center gap-3">
              <div class="bg-gray-100 p-2 rounded-lg">
                <i data-lucide="graduation-cap" class="w-6 h-6 text-muted"></i>
              </div>
              <div>
                <div class="font-bold text-[var(--text)]">Biola University</div>
                <div class="text-xs text-muted">B.A. Psychology</div>
              </div>
            </div>
            <div class="hidden sm:block w-px h-8 bg-border"></div>
            <div class="flex items-center gap-3">
              <div class="bg-yellow-50 p-2 rounded-lg">
                <i data-lucide="book-open" class="w-6 h-6 text-yellow-700"></i>
              </div>
              <div>
                <div class="font-bold text-[var(--text)]">Torrey Honors College</div>
                <div class="text-xs text-muted">Socratic Logic & Writing</div>
              </div>
            </div>
          </div>
        </div>

        <div class="flex flex-wrap justify-center md:justify-start gap-4">
          <a href="/assets/pdfs/Resume.pdf" target="_blank" class="btn-secondary px-6 py-3 rounded-xl inline-flex items-center gap-2">
            <i data-lucide="file-text" class="w-4 h-4"></i> Download Resume
          </a>
        </div>
      </div>

      <!-- Headshot -->
      <div class="flex-shrink-0 relative group">
        <div class="w-48 h-48 md:w-64 md:h-64 rounded-full border-4 border-surface shadow-2xl overflow-hidden bg-gray-200 relative">
          <!-- User to replace with actual image -->
          <img src="/Images/profile.png" alt="Joseph Abboud" class="w-full h-full object-cover">
        </div>
        <div class="absolute bottom-4 right-4 bg-surface px-3 py-1 rounded-full shadow-lg border border-border flex items-center gap-1.5 animate-bounce" style="animation-duration: 3s;">
          <span class="text-lg">ðŸ’¼</span>
          <span class="text-xs font-bold">Open To Work!</span>
        </div>
      </div>
    </div>
  </header>

  <main class="max-w-5xl mx-auto px-6 py-10">
    <style>
      main {
        display: flex;
        flex-direction: column;
        gap: 2.5rem;
      }
      [data-section-order="0"] { order: 0; }
      [data-section-order="1"] { order: 1; }
      [data-section-order="2"] { order: 2; }
      [data-section-order="3"] { order: 3; }
      [data-section-order="4"] { order: 4; }
    </style>

    <!-- Section: Top Skills (Featured Skills) -->
    <!-- 
      Skills are now derived relationally from experience files.
      A skill appears here if it's referenced in the tools/tags of experience files
      for the current mode (research, business, journalism, aba).
      Set featured: true in skill files to prioritize them in the display.
    -->
    <div id="top-skills-container" data-mode={currentMode}>
      <TopSkills currentMode={currentMode} />
    </div>

    {/* Research Section */}
    <section id="research" data-section-order={sectionOrder.indexOf('research')} class="scroll-mt-24 transition-colors duration-1000 p-4 -m-4 rounded-2xl">
      <div class="flex flex-col md:flex-row md:items-end justify-between mb-8 gap-4">
        <div>
          <h2 class="text-3xl font-serif font-bold mb-2 flex items-center gap-2">
            <i data-lucide="microscope" class="w-6 h-6 text-muted"></i>
            Research & Psychology
          </h2>
          <p class="text-muted max-w-lg">Experimental design, protocol management, and data analysis.</p>
        </div>
      </div>

      <div class="space-y-6">
        {sortedResearch.map((item) => (
          <div class="card p-1">
            <details class="group open:bg-surface-2/30 rounded-xl transition-colors">
              <summary class="p-6 md:p-8 flex flex-col md:flex-row gap-6 cursor-pointer relative list-none">
                <div class="flex-grow">
                  <div class="flex flex-wrap items-center gap-3 mb-2">
                    <h3 class="text-xl font-serif font-bold group-hover:text-info transition-colors">{item.data.title}</h3>
                    <span class="pill bg-yellow-50 text-yellow-800 border-yellow-200">{item.data.role}</span>
                  </div>
                  {item.data.conference && (
                    <p class="text-lg font-medium text-[var(--text)] mb-3">
                      {item.data.conference}
                    </p>
                  )}
                  <p class="text-sm text-muted mb-4 leading-relaxed line-clamp-2">
                    {item.data.methodology || (item.data.posterUrl ? "Poster presentation - Click to view details..." : "Click to expand details...")}
                  </p>
                  <div class="flex items-center gap-2 text-sm font-semibold text-info">
                    <i data-lucide="chevron-down" class="w-4 h-4 group-open:rotate-180 transition-transform"></i>
                    <span class="group-open:hidden">View Methodology & Findings</span>
                    <span class="hidden group-open:inline">Hide details</span>
                  </div>
                </div>
                <div class="md:w-48 flex-shrink-0 md:border-l border-border md:pl-6 flex flex-col gap-3">
                  <span class="text-xs font-bold uppercase tracking-wider text-muted">Relevant Skills</span>
                  <div class="flex flex-wrap gap-2">
                    {item.data.tools.map((tool) => (
                      <span class="pill">{tool}</span>
                    ))}
                  </div>
                </div>
              </summary>
              <div class="px-6 pb-6 md:px-8 md:pb-8 pt-0 border-t border-border mt-2">
                <div class="grid md:grid-cols-2 gap-8 pt-6">
                  <div>
                    <h4 class="text-sm font-bold uppercase tracking-wide text-muted mb-3">Methodology</h4>
                    <p class="text-sm text-[var(--text)] leading-relaxed mb-4">
                      {item.data.methodology}
                    </p>
                    {item.data.posterUrl && (
                      <button 
                        onclick={`openPosterModal('${item.data.posterUrl}', '${item.data.title}')`}
                        class="btn-primary px-4 py-2 rounded-lg text-sm inline-flex items-center gap-2"
                      >
                        <i data-lucide="maximize-2" class="w-4 h-4"></i> View Poster PDF
                      </button>
                    )}
                  </div>
                  <div>
                     {item.data.findings && (
                      <>
                        <h4 class="text-sm font-bold uppercase tracking-wide text-muted mb-3">Key Findings</h4>
                        <ul class="list-disc pl-4 space-y-2 text-sm text-[var(--text)]">
                          {item.data.findings.map((point) => (
                            <li>{point}</li>
                          ))}
                        </ul>
                      </>
                    )}
                  </div>
                </div>
              </div>
            </details>
          </div>
        ))}
      </div>
    </section>

    {/* Business & Leadership Section */}
    {(sortedBusiness.length > 0 || sortedLeadership.length > 0) && (
      <section id="business-leadership" data-section-order={sectionOrder.indexOf('business-leadership')} class="scroll-mt-24 transition-colors duration-1000 p-4 -m-4 rounded-2xl">
        <div class="flex flex-col md:flex-row md:items-end justify-between mb-8 gap-4">
          <div>
            <h2 class="text-3xl font-serif font-bold mb-2 flex items-center gap-2">
              <i data-lucide="briefcase" class="w-6 h-6 text-muted"></i>
              Business & Leadership
            </h2>
            <p class="text-muted max-w-lg">E-commerce operations, business development, and team management.</p>
          </div>
        </div>

        <div class="grid md:grid-cols-2 gap-6">
          {/* Business Ventures */}
          {sortedBusiness.map((item) => (
            <div class="card p-6 md:p-8">
              <div class="flex justify-between items-start mb-4">
                <div>
                  <h3 class="text-lg font-serif font-bold">{item.data.role}</h3>
                  <div class="text-sm text-muted">{item.data.organization} â€¢ {item.data.dateStart.getFullYear()} - {item.data.dateEnd ? item.data.dateEnd.getFullYear() : 'Present'}</div>
                </div>
                {item.data.tags && item.data.tags.length > 0 && (
                  <div class="flex flex-wrap gap-2">
                    {item.data.tags.map((tag) => (
                      <span class="pill">{tag}</span>
                    ))}
                  </div>
                )}
              </div>
              <p class="text-sm text-muted leading-relaxed mb-4">
                {item.data.summary}
              </p>
              {item.data.metrics && (
                <div class="flex gap-4 border-t border-border pt-4">
                  {item.data.metrics.map((m) => (
                    <div>
                      <div class="text-lg font-bold font-serif">{m.value}</div>
                      <div class="text-xs text-muted uppercase">{m.label}</div>
                    </div>
                  ))}
                </div>
              )}
            </div>
          ))}
          
          {/* Leadership Roles */}
          {sortedLeadership.map((item) => (
            <div class="card p-6 md:p-8">
              <div class="flex justify-between items-start mb-4">
                <div>
                  <h3 class="text-lg font-serif font-bold">{item.data.role}</h3>
                  <div class="text-sm text-muted">{item.data.organization} â€¢ {item.data.dateStart.getFullYear()} - {item.data.dateEnd ? item.data.dateEnd.getFullYear() : 'Present'}</div>
                </div>
                {item.data.tags && item.data.tags.length > 0 && (
                  <div class="flex flex-wrap gap-2">
                    {item.data.tags.map((tag) => (
                      <span class="pill">{tag}</span>
                    ))}
                  </div>
                )}
              </div>
              <p class="text-sm text-muted leading-relaxed mb-4">
                {item.data.summary}
              </p>
              {item.data.metrics && (
                <div class="flex gap-4 border-t border-border pt-4">
                  {item.data.metrics.map((m) => (
                    <div>
                      <div class="text-lg font-bold font-serif">{m.value}</div>
                      <div class="text-xs text-muted uppercase">{m.label}</div>
                    </div>
                  ))}
                </div>
              )}
            </div>
          ))}
        </div>
      </section>
    )}

    {/* Journalism Section */}
    <section id="journalism" data-section-order={sectionOrder.indexOf('journalism')} class="scroll-mt-24 transition-colors duration-1000 p-4 -m-4 rounded-2xl">
      <div class="flex flex-col md:flex-row md:items-end justify-between mb-8 gap-4">
        <div>
          <h2 class="text-3xl font-serif font-bold mb-2 flex items-center gap-2">
            <i data-lucide="newspaper" class="w-6 h-6 text-muted"></i>
            Journalism & Media
          </h2>
          <p class="text-muted max-w-lg">Investigative reporting and multimedia content.</p>
        </div>
        
        <div class="flex bg-surface border border-border rounded-full p-1">
          <span class="px-4 py-1.5 rounded-full text-sm font-medium bg-[var(--text)] text-surface">All Content</span>
        </div>
      </div>

      <div class="grid md:grid-cols-2 lg:grid-cols-3 gap-6" id="journalism-grid">
        {sortedJournalism.map((item, index) => (
          <article class="card p-1 flex flex-col h-full">
            <div class="p-6 flex flex-col h-full">
              {/* Publication Badge + Year */}
              <div class="flex justify-between items-center mb-3">
                <span class={`pill ${item.data.type === 'Article' ? 'bg-blue-50 text-blue-800 border-blue-200' : 'bg-purple-50 text-purple-800 border-purple-200'}`}>
                  {item.data.type === 'Article' ? (
                    <>
                      <i data-lucide="file-text" class="w-3 h-3"></i>
                      <span>{item.data.publication || 'Article'}</span>
                    </>
                  ) : (
                    <>
                      <i data-lucide="instagram" class="w-3 h-3"></i>
                      <span>{item.data.publication || 'Social'}</span>
                    </>
                  )}
                </span>
                <span class="text-xs text-muted font-medium">{item.data.date.getFullYear()}</span>
              </div>
              
              {/* Title - Clickable */}
              <h3 class="text-xl font-serif font-bold mb-3 leading-tight">
                <a 
                  href={item.data.url} 
                  target="_blank" 
                  class="hover:underline decoration-brand decoration-2 underline-offset-2 text-[var(--text)]"
                >
                  {item.data.title}
                </a>
              </h3>
              
              {/* Summary */}
              <p class="text-muted text-sm mb-4 flex-grow leading-relaxed line-clamp-3">
                {item.data.summary}
              </p>
              
              {/* Actions Row */}
              <div class="mt-auto pt-4 flex items-center border-t border-border">
                <a 
                  href={item.data.url} 
                  target="_blank" 
                  class="text-xs font-semibold flex items-center gap-1.5 hover:text-info transition-colors"
                >
                  {item.data.type === 'Article' ? 'Read Article' : 'View Post'} 
                  <i data-lucide="external-link" class="w-3 h-3"></i>
                </a>
              </div>
            </div>
          </article>
        ))}
      </div>
    </section>

    {/* Technical Skills Section */}
    <section id="skills" data-section-order={sectionOrder.indexOf('skills')} class="scroll-mt-24 transition-colors duration-1000 p-4 -m-4 rounded-2xl">
      <div class="flex flex-col md:flex-row md:items-end justify-between mb-8 gap-4">
        <div>
          <h2 class="text-3xl font-serif font-bold mb-2 flex items-center gap-2">
            <i data-lucide="wrench" class="w-6 h-6 text-muted"></i>
            Technical Toolkit & Certifications
          </h2>
          <p class="text-muted max-w-lg">Software proficiency, research tools, and professional certifications.</p>
        </div>
      </div>

      <TechnicalSkills skills={sortedSkills} />
    </section>

    <!-- Contact -->
    <section id="contact" data-section-order={sectionOrder.indexOf('contact')} class="scroll-mt-24 transition-colors duration-1000 p-4 -m-4 rounded-2xl">
      <div class="bg-surface border border-border rounded-2xl p-10 md:p-16 text-center">
        <h2 class="text-3xl md:text-4xl font-bold mb-6">Let's Connect.</h2>
        <p class="text-muted max-w-xl mx-auto mb-8 text-lg">
          Currently available for RBT and Research Coordinator roles.
        </p>
        <div class="flex justify-center gap-4">
          <a href="https://linkedin.com/in/josephabboud" target="_blank" class="btn-primary px-8 py-4 rounded-xl text-lg inline-flex items-center gap-3 shadow-lg shadow-yellow-500/20">
            <i data-lucide="linkedin" class="w-5 h-5"></i>
            Connect on LinkedIn
          </a>
        </div>
      </div>
      <footer class="mt-16 text-center text-sm text-muted">
        <p>&copy; 2025 Joseph Abboud. Built with Astro & Tailwind.</p>
      </footer>
    </section>

  </main>

  <!-- Poster Modal -->
  <dialog id="poster-modal" class="backdrop:bg-gray-900/50 p-0 rounded-xl shadow-2xl w-full max-w-4xl max-h-[90vh] overflow-hidden">
    <div class="flex flex-col h-full max-h-[90vh] bg-surface">
      <div class="flex-shrink-0 p-4 border-b border-border flex justify-between items-center bg-surface-2">
        <h3 id="poster-modal-title" class="font-bold">Research Poster</h3>
        <form method="dialog"><button class="p-2 hover:bg-border rounded-full" aria-label="Close"><i data-lucide="x" class="w-5 h-5"></i></button></form>
      </div>
      <div class="flex-1 overflow-auto p-4 bg-gray-100 flex justify-center items-start min-h-0">
        <iframe 
          id="poster-iframe"
          src=""
          class="w-full border border-border rounded-lg"
          style="display: none; min-height: 600px; height: 100%;"
          title="Research Poster PDF"
        ></iframe>
        <div id="poster-placeholder" class="text-center">
          <i data-lucide="file-image" class="w-16 h-16 text-muted mx-auto mb-4"></i>
          <p class="text-muted">Loading poster...</p>
        </div>
      </div>
      <div class="flex-shrink-0 p-4 border-t border-border flex justify-end gap-3 bg-surface-2">
        <a 
          id="poster-download-link"
          href=""
          download
          class="btn-secondary px-4 py-2 rounded-lg text-sm inline-flex items-center gap-2"
          style="display: none;"
        >
          <i data-lucide="download" class="w-4 h-4"></i> Download PDF
        </a>
        <form method="dialog">
          <button class="btn-primary px-4 py-2 rounded-lg text-sm inline-flex items-center gap-2">
            Close
          </button>
        </form>
      </div>
    </div>
  </dialog>

  <!-- Poster Modal Script -->
  <script is:inline>
    function openPosterModal(posterUrl, title) {
      const modal = document.getElementById('poster-modal');
      const iframe = document.getElementById('poster-iframe');
      const placeholder = document.getElementById('poster-placeholder');
      const downloadLink = document.getElementById('poster-download-link');
      const modalTitle = document.getElementById('poster-modal-title');
      
      if (!modal || !iframe || !placeholder || !downloadLink || !modalTitle) return;
      
      // Set modal title
      modalTitle.textContent = title || 'Research Poster';
      
      // Set iframe source to PDF
      iframe.src = posterUrl;
      iframe.style.display = 'block';
      placeholder.style.display = 'none';
      
      // Set download link
      downloadLink.href = posterUrl;
      downloadLink.style.display = 'inline-flex';
      
      // Show modal
      modal.showModal();
      
      // Re-initialize Lucide icons after modal opens
      if (typeof lucide !== 'undefined') {
        setTimeout(() => lucide.createIcons(), 100);
      }
    }
    
    // Reset modal when closed
    document.getElementById('poster-modal')?.addEventListener('close', function() {
      const iframe = document.getElementById('poster-iframe');
      const placeholder = document.getElementById('poster-placeholder');
      const downloadLink = document.getElementById('poster-download-link');
      
      if (iframe) {
        iframe.src = '';
        iframe.style.display = 'none';
      }
      if (placeholder) {
        placeholder.style.display = 'block';
      }
      if (downloadLink) {
        downloadLink.href = '';
        downloadLink.style.display = 'none';
      }
    });
  </script>

  <!-- Debug: Monitor Details Elements -->
  <script is:inline>
    // #region agent log
    (function() {
      const logEndpoint = 'http://127.0.0.1:7244/ingest/a7ca4eda-4f6b-42fd-97e8-abf86a8386d5';
      function debugLog(location, message, data, hypothesisId) {
        fetch(logEndpoint, {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({
            location: location,
            message: message,
            data: data,
            timestamp: Date.now(),
            sessionId: 'debug-session',
            runId: 'run1',
            hypothesisId: hypothesisId
          })
        }).catch(() => {});
      }
      
    })();
    // #endregion
  </script>

  <!-- Sticky Chameleon Script -->
  <script is:inline>
    // 1. Check URL params
    const params = new URLSearchParams(window.location.search);
    // Default to 'research' for Psychology/Research roles (T-Shaped profile)
    let currentMode = localStorage.getItem('portfolioMode') || 'research';

    // 2. Set Mode (URL overrides storage)
    if (params.has('r')) currentMode = 'research';
    if (params.has('b')) currentMode = 'business';
    if (params.has('a')) currentMode = 'aba';
    if (params.has('j')) currentMode = 'journalism';

    // 3. Save to Storage
    if (currentMode) localStorage.setItem('portfolioMode', currentMode);

    // 4. Update Top Skills mode (for client component reactivity)
    const topSkillsContainer = document.getElementById('top-skills-container');
    if (topSkillsContainer) {
      topSkillsContainer.setAttribute('data-mode', currentMode);
      // Dispatch custom event for TopSkills component to react
      topSkillsContainer.dispatchEvent(new CustomEvent('modechange', { 
        detail: { mode: currentMode } 
      }));
    }

    // 5. Scroll to section if URL param is present (hero is now server-rendered)
    const researchSec = document.getElementById('research');
    const businessLeadershipSec = document.getElementById('business-leadership');
    const journalismSec = document.getElementById('journalism');

    if (params.has('r') && researchSec) {
      setTimeout(() => researchSec.scrollIntoView({ behavior: 'smooth' }), 500);
      researchSec.classList.add('animate-flash-focus');
    } else if (params.has('a') && researchSec) {
      setTimeout(() => researchSec.scrollIntoView({ behavior: 'smooth' }), 500);
      researchSec.classList.add('animate-flash-focus');
    } else if (params.has('j') && journalismSec) {
      setTimeout(() => journalismSec.scrollIntoView({ behavior: 'smooth' }), 500);
      journalismSec.classList.add('animate-flash-focus');
    } else if (params.has('b') && businessLeadershipSec) {
      setTimeout(() => businessLeadershipSec.scrollIntoView({ behavior: 'smooth' }), 500);
      businessLeadershipSec.classList.add('animate-flash-focus');
    }
  </script>
</BaseLayout>